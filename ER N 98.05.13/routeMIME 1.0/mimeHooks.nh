DefConst ( 'kER_TPSymbol_for_MIME, '|EnRouteN1:Netstrategy| );DefConst ( 'kER_Install_MIME_extn, func ( appSymbol )	begin	local rootFrame := GetRoot().(appSymbol);	if rootFrame then		rootFrame:?XTNInstallScript();	else		print ( "UNABLE TO INSTALL EnRoute MIME EXTENSION" );	end );DefConst ( 'kER_Remove_MIME_extn, func()	begin	// Look up which transports we're installed in	// This should only be '|EnRouteN1:Netstrategy| for a	// MIME extension.	// While we're at it we'll remove our reference from	// the EnRoute Core's globals to prevent a re-hook	// attempt if i-net is reinstalled.	local tpSymbols := [];	local gEnRoute := GetGlobalVar ( 'EnRouteCore );	if gEnRoute then		begin		local extendA := gEnRoute.extended;		if extendA and Length ( extendA ) > 0 then			begin			local inIx;			while ( inIx := LSearch ( extendA, kAppSymbol, 0, '|=|, 'id ) ) do				begin				AddArraySlot ( tpSymbols, extendA[inIx].transportSym );				ArrayRemoveCount ( extendA, inIx, 1 );				if kDebugOn then print ( "Removed from EnRoute Core" );				end;			end;		end;	// Now that we know where we're attached, we'll	// remove ourselves from the two extension arrays	// where we hooked ourselves if the transport is	// still active (ie: loaded and not frozen).	local tpSym;	foreach tpSym in tpSymbols do		begin		if tpSym then			begin			local transport := GetRoot().(tpSym);			if transport and transport.mimeExtns then				begin				// we hooked "mimeExtns"				local extnsA := transport.mimeExtns;				local inIx;				while ( inIx := LSearch ( extnsA, kAppSymbol, 0, '|=|, 'id ) ) do					begin					ArrayRemoveCount ( extnsA, inIx, 1 );					if kDebugOn then						begin						write ( "Removed " );						print ( kAppSymbol );						write ( " from mimeExtns\n" );						end;					end;				if Length ( transport.mimeExtns ) = 0 then					RemoveSlot ( transport, 'mimeExtns );				end;			if transport and transport.rxExtns then				begin				// we hooked "rxExtns"				local extnsA := transport.rxExtns;				local inIx;				while ( inIx := LSearch ( extnsA, kAppSymbol, 0, '|=|, 'id ) ) do					begin					ArrayRemoveCount ( extnsA, inIx, 1 );					if kDebugOn then						begin						write ( " - also removed from rxExtns\n" );						end;					end;				if Length ( transport.rxExtns ) = 0 then					RemoveSlot ( transport, 'rxExtns );				end;			end;		end;	end );